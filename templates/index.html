<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chat Application</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <script>
        const username = "{{ username }}";
        const currentUser = {
            id: {{ current_user.id }},
            username: "{{ username }}"
        };
    </script>
    <script src="{{ url_for('static', filename='js/scripts.js') }}" defer></script>
</head>
<body>
    <h1>Chat Application</h1>
    <h2>Welcome, {{ username }}</h2>
    <input type="text" id="search" placeholder="Search users..." oninput="searchUsers()">
    <ul id="user-list">
        {% for user in users %}
        <li>
            <div>
                <strong>{{ user[1] }}</strong><br>
                <small>Last message: {{ user[3] or 'No messages yet' }}</small><br>
                <button onclick="window.location.href='{{ url_for('chat', recipient_username=user[1]) }}'">Chat</button>
            </div>
        </li>
        {% endfor %}
    </ul>
    <ul id="search-results"></ul>
    <a href="{{ url_for('logout') }}">Logout</a>
</body>
</html>
